<!--index.wxml-->
<van-notice-bar left-icon="volume-o" text="OpenAI 额度有限，每人每天只能生成 10 次哦~" />
<view class="container">
  <van-row gutter="20">
    <van-col>
      <van-field value="{{value}}" placeholder="请输入场景描述" bind:change="onTextChange" />
    </van-col>
    <van-col>
      <van-button hairline plain type="primary" bind:click="postToGenerate" loading="{{loading}}">生成</van-button>
    </van-col>
  </van-row>
  <van-row>
    <view wx:if="{{images.length === 0}}">
      <view wx:if="{{!loading}}">
        <van-empty description="尝试生成一张图片吧～" />
      </view>
      <view wx:else>
        <van-empty image="search" description="正在生成中，稍等哦～" />
      </view>
    </view>
    <view wx:else>
      <view wx:for="{{images}}">
        <van-image use-error-slot use-loading-slot fit="cover" width="16rem" height="16rem" src="{{item}}">
          <van-loading slot="loading" type="spinner" color="#1989fa" size="20" vertical />
          <text slot="error">加载失败</text>
        </van-image>
      </view>
    </view>
  </van-row>
  <van-circle clockwise="{{false}}" size="80" value="{{(1-currentUsages/dailyLimits)*100}}" text="今余: {{dailyLimits-currentUsages}}" />
</view>